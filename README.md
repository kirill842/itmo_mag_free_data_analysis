**Обнаружение мошеннических операций с помощью GBDT**

---

**Обзор проекта**
Проект реализует выявление мошеннических финансовых транзакций с помощью обучения GBDT версии LightGBM. Реализованы этапы загрузки данных, EDA, создания признаков, разбиения данных с учетом времени, оптимизации гиперпараметров и оценки модели на тестовой выборке.

---

**Ключевые стороны эксперимента**

* **Загрузка и предобработка данных**

  * Чтение логов транзакций и исторических курсов валют из Parquet‑файлов.
  * Сортировка по времени для сохранения хронологии и предотвращения утечки данных.

* **Создание признаков**

  * Конвертация всех сумм транзакций в USD с использованием ежедневных курсов.
  * Генерация признаков активности за последний час (число транзакций, сумма, максимальная сумма, число уникальных продавцов и стран).
  * Выделение временных признаков: час дня и день недели.
  * Кодирование категориальных признаков (устройство, продавец, канал, география, тип карты и валюты) для LightGBM.

* **Разведочный анализ данных (EDA)**

  * Вычисление общего уровня мошенничества и выявление паттернов пропусков.
  * Визуализация распределения сумм транзакций и дисбаланса классов с помощью boxplot, гистограмм и тепловых карт.
  * Анализ сезонности мошенничества по часам и дням недели.

* **Временное разбиение данных**

  * Реализация 70/15/15 разбиения на тренировочную, валидационную и тестовую выборки с учётом хронологического порядка для имитации реальных условий в продакшене.

* **Настройка гиперпараметров**

  * Использование `RandomizedSearchCV` с `TimeSeriesSplit` для подбора learning rate и количества деревьев.
  * Оптимизация по метрике ROC‑AUC для надёжного различения мошеннических и легитимных транзакций.

* **Оценка модели**

  * Построение графиков precision–recall по порогу для балансировки полноты и точности.
  * Подробные метрики классификации и матрица ошибок на тестовой выборке.
  * Достигнута **полнота 97.2 %** на тесте — приоритет на выявление мошенничества даже ценой ложных срабатываний.

* **Анализ важности признаков**

  * Визуализация ключевых факторов, влияющих на решение модели, для информирования команды риск‑менеджмента.

---

**Результаты и значение**

* **Высокая полнота (97.2 %)** гарантирует обнаружение подавляющего большинства мошеннических операций, снижая убытки клиентов.
* **Интерпретируемые признаки** позволяют экспертам доверять решениям модели.
* **Модульная и масштабируемая кодовая база** в формате Jupyter‑скриптов упрощает итерации и интеграцию в продакшен.

---

**Технологический стек**

* **Языки и библиотеки:** Python, pandas, NumPy, scikit‑learn, LightGBM, matplotlib, seaborn, tqdm
* **Контроль версий и CI/CD:** GitHub (с этим README), автоматизированные тестовые пайплайны (опционально)
* **Хранение данных:** Parquet для эффективного ввода‑вывода

---

**Начало работы**

1. **Клонировать репозиторий**

   ```bash
   git clone https://github.com/your-username/fraud-detection-lightgbm.git
   cd fraud-detection-lightgbm
   ```
2. **Установить зависимости**

   ```bash
   pip install -r requirements.txt
   ```
3. **Подготовить данные**

   * Поместить `transaction_fraud_data.parquet` и `historical_currency_exchange.parquet` в папку `data/`.
4. **Запустить конвейер**

   ```bash
   python main.py
   ```

---
