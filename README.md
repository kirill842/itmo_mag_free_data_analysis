**Обнаружение мошеннических операций с помощью GBDT**

---

**Обзор проекта**

Проект реализует выявление мошеннических финансовых транзакций с помощью обучения GBDT версии LightGBM. Реализованы этапы загрузки данных, EDA, создания признаков, разбиения данных с учетом времени, оптимизации гиперпараметров и оценки модели на тестовой выборке.

---

**Ключевые этапы в проведенном эксперименте**

* **Загрузка и предобработка данных**

  * Чтение логов транзакций и исторических курсов валют из Parquet‑файлов.
  * Сортировка по времени для сохранения хронологии и предотвращения data-leakage.

* **Создание признаков**

  * Конвертация всех сумм транзакций в USD с использованием ежедневных курсов.
  * Использование признаков активности за последний час (число транзакций, сумма, максимальная сумма, число уникальных продавцов и стран).
  * Выделение временных признаков: час дня и день недели.
  * Использованы возможности LightGBM для эффективной работы с категориальными признаками, поэтому категориальные признаки не требовали ручной предобработки.

* **Разведочный анализ данных (EDA)**

  * Вычисление общего уровня мошенничества, указывающего на дисбаланс классов.
  * Выявление пропусков в данных.
  * Визуализация распределения сумм транзакций по классам с помощью boxplot, гистограмм.
  * Анализ на линейные корреляции с визуализацией на тепловой карте.
  * Анализ сезонности мошенничества по часам и дням недели.

* **Временное разбиение данных**

  * Использовалось 70/15/15 разбиения на тренировочную, валидационную и тестовую выборки с учётом хронологического порядка для имитации реальных условий в продакшене.

* **Настройка гиперпараметров**

  * Использование `RandomizedSearchCV` с `TimeSeriesSplit` для подбора learning rate и количества деревьев.
  * Оптимизация гиперпараметров проводилась по метрике ROC‑AUC.

* **Обучение модели**

  * Финальное обучение модели проводилось с лучшими гиперпараметрами: количеством деревьев = 100 и learning rate = 0.01.
  * Были заданы бОльшие веса для положительного класса, чем для отрицательного, чтобы учесть дисбаланс и не просадить Recall.

* **Оценка модели**

  * Построение графиков precision–recall по порогу для выявления лучшего баланса полноты и точности.
  * Были вычислены подробные метрики классификации и матрицы ошибок на тестовой выборке.
  * Достигнут **Recall 97.2 % при Precision 91%** на тесте — приоритет ставился на выявление мошенничества, когда блок валидных операций очевидно не так критичен (можно запросить подтверждение у пользователя например с помощью отпечатка пальцев или дополнительного пин-кода).

* **Анализ важности признаков**

  * Визуализация ключевых факторов, влияющих на решение модели.

---

**Результаты и значение**

* **Высокий Recall (97.2 %) при хорошем Precision (91%)** гарантирует обнаружение подавляющего большинства мошеннических операций, снижая недовольство и повышая лояльность пользователей.
* Построенную модель можно оформить в виде сервиса в production и реализовать следующую систему на ее основе: перед совершением каждой операции ее классифицировать: если валидная - проводим, если не валидная - просим дополнительную идентификацию пользователя (действительный пользователь ее легко пройдет, а мошенническая операция будет заблокирована)

---

**Технологический стек**

* **Языки и библиотеки:** Python, pandas, NumPy, scikit‑learn, LightGBM, matplotlib, seaborn, tqdm

---

**Начало работы**

1. **Клонировать репозиторий**

   ```bash
   git clone https://github.com/kirill842/itmo_mag_free_data_analysis
   cd itmo_mag_free_data_analysis
   ```
2. **Установить Python**

   * Python 3.11.13 [Download](https://www.python.org/downloads/release/python-31113/)
3. **Установить зависимости**

   ```bash
   pip install -r requirements.txt
   ```
4. **Подготовить данные**

   * Поместить `transaction_fraud_data.parquet` и `historical_currency_exchange.parquet` в папку с проектом.
5. **Начало работы**

   * Открыть проект в Jupyter Notebook

---
